create database employee;
use employee;
create table employeetable(emp_id int primary key,firstname varchar(255),lastname varchar(255),salary long,joining_date date,department varchar(255));
insert into employeetable(emp_id,firstname,lastname,salary,joining_date,department) values(1,"Venkatsh","s",100000,"2015/08/28","BANKING");
insert into employeetable(emp_id,firstname,lastname,salary,joining_date,department) values (2,"Ragavi","P",7500,"2015/08/28","BUSINESS"),
(3,"Gopinath","C",50000,"2016-03-02","PHARMA"),
(4,"Dinesh","G",50000,"2016/03/02","INSURANCE"),
(5,"Saibabu","E",40000,"2017/03/02","SOFTWARE"),
(6,"Hasan","S",29000,"2017/07/08","MANUFACTURING"),
(7,"Divya","P",3employeetable3000,"2017/07/08","HEALTHCARE"),
(8,"Aravindan","R",40000,"2017/07/08","HEALTHCARE"),
(9,"Sathish","MD",45000,"2016/03/02","AUTOMOBLIE"),
(10,"Prasanth","PKP",34000,"2016/03/02","INSURANCE"),
(11,"Vijay","R",25684,"2016/03/02","BUSINESS"),
(12,"Sivakumar","K",54789,"2016/03/02","SOFTWARE");
-- Get all employee details from the employee table 
Select * from employeetable;
-- Get First_Name,Last_Name from employee table
select firstname,lastname from employeetable;
-- Get First_Name from employee table using alias name “Employee Name”
select firstname as employee_name from employeetable;
-- Get First_Name from employee table in upper case
select upper(firstname) from employeetable;
-- Get First_Name from employee table in lower case
select lower(firstname) from employeetable;
-- Get unique DEPARTMENT from employee table
select distinct department from employeetable; 
--  Select first 3 characters of FIRST_NAME from EMPLOYEE
select substring(firstname,1,3) from employeetable;
 -- Get position of 'a' in name 'ragavi' from employee table
select position("a"in"ragavi") from employeetable;
-- Get FIRST_NAME from employee table after removing white spaces from right side
 select ltrim(f=irstname),rtrim(firstname) from employeetable;
 --  Get FIRST_NAME from employee table after removing white spaces from left side
-- Get length of FIRST_NAME from employee table
select length(firstname) from employeetable;
-- Get length of FIRST_NAME from employee table
select replace(firstname,"a","$") from employeetable;
-- . Get First_Name from employee table after replacing 'a' with '$'
select concat(firstname," ",lastname) from employeetable;
-- Get First_Name and Last_Name as single column from employee table separated by a '_'
select firstname,year(joining_date),month(joining_date),date(joining_date) from employeetable;
-- Get all employee details from the employee table order by First_Name Ascending
select * from employeetable order by firstname asc;
-- Get all employee details from the employee table order by First_Name descending
select * from employeetable order by firstname desc;
--  Get all employee details from the employee table order by First_Name Ascending and Salary descending
select * from employeetable order by firstname asc,salary desc;
select * from employeetable where salary>=50000 and salary<=70000;
--  Get employee details from employee table whose employee name is “Dinesh”
select * from employeetable where firstname="Dinesh";
--  Get employee details from employee table whose employee name are “Dinesh” and “Roy
 select * from employeetable where firstname="Dinesh" or firstname="Roy";
 -- Get employee details from employee table whose employee name are not “Dinesh” and “Roy”
 select * from employeetable where not firstname="disnesh" and not firstname="Roy";
 --  Get all the details of the employee whose salary is greater than 60000.
 select * from employeetable where salary>60000;
--  Get all the details of the employee whose salary is between 50000 to 70000
select * from employeetable where salary>50000 && salary>70000;
-- Get first name and last name as single column separated by space of the employee whose salary is less than 50000
 select concat(firstname,"_",lastname)from employeetable where salary<=50000;
-- Get first name and salary, arrange it by salary in ascending order.
select firstname,salary from employeetable order by salary;
-- Get all the details of the employee whose salary is between 50000 to 70000 and arrange them by their first name as ascending order.
select * from employeetable where salary>=50000 and salary<=70000 order by firstname;
select firstname from employeetable where firstname like "s%";
select firstname from employeetable where firstname like "%h";
--  Get employee details from employee table whose first name contains 'v'
select firstname from employeetable where firstname like "v%";
-- Get employee details from employee table whose first name ends with 'n'
select firstname from employeetable where firstname like "%N";
-- Get employee details from employee table whose first name ends with 'n' and name contains 4 letters
select firstname from employeetable where firstname like "____N";
--   Get employee details from employee table whose first name starts with 'J' and name contains 4 letters
select firstname from employeetable where firstname like "j____";
--  Get employee details from employee table whose first name starts with 'J' and name contains 4 letters
select firstname from employeetable where salary>60000;
--  Get employee details from employee table who’s Salary less than 80000
select firstname from employeetable where salary<80000;
-- Get employee details from employee table who’s Salary between 50000 and 80000
select * from employeetable where salary>50000 and salary<80000;
-- Get employee details from employee table whose name is venkatesh and ragavi
select * from employeetable where firstname="venkatesh" or firstname="ragavi";
-- Get employee details from employee table whose joining year is “2015”
select * from employeetable where year(joining_date)=2015;
-- . Get employee details from employee table whose joining month is “January”
select * from employeetable where month(joining_date)=01;
-- Get employee details from employee table who joined before January 1st 2017
select * from employeetable where joining_date<"2017/01/01";
-- Get employee details from employee table who joined after January 31st 2016
select * from employeetable where joining_date>"2016/01/31";
-- Get department,total salary with respect to a department from employee table.
select department,sum(salary)from employeetable group by department;
-- Get department,total salary with respect to a department from employee table order by total salary descending
select department,sum(salary) from employeetable group by department order by sum(salary) desc;
--  Get department,no of employees in a department,total salary with respect to a department from employee table order by total salary descending
select department,count(department),sum(salary) from employeetable group by department order by sum(salary) desc;
--  Get department wise average salary from employee table order by salary ascending
select department,avg(salary) from employeetable group by department order by sum(salary)asc;
-- Get department wise maximum salary from employee table order by salary ascending
select department,max(salary)from employeetable group by department order by max(salary) asc;
-- Get department wise minimum salary from employee table order by salary ascending
select department,min(salary)from employeetable group by department order by min(salary) asc;
--  Select no of employees joined with respect to year and month from employee table
select joining_date,count(year(joining_date)and month(joining_date)) from employeetable group by joining_date;
-- Select department,total salary with respect to a department from employee table where total salary greater than 800000 order by Total_Salary descending
select department,sum(salary) from employeetable group by department having sum(salary)>80000 order by sum(salary) desc;
select * from employeetable;
update employeetable set firstname="Dileepkumar",lastname="T" where firstname="Ragavi";
delete from employeetable where emp_id=3;
set sql_safe_updates=0;

create table incentives(id int,incentive_date date,incentive_amount int);
insert into  incentives(id,incentive_date,incentive_amount)value(1,"2016/02/01",5000),
(2,"2016/02/01",3000),
(3,"2017/02/01",4000),
(1,"2017/02/01",4500),
(2,"2017/02/01",3500);
select * from incentives;
-- Get the employee name, add the salary and total incentive amount from incentive table use join with conditions
select e.firstname,sum(e.salary+i.incentive_amount) from employeetable e join incentives i where e.emp_id=i.id group by e.firstname,e.salary;
select e.firstname,(e.salary+ifnull(sum(i.incentive_amount),0))from employeetable e join incentives i on e.emp_id=i.id group by e.firstname,e.salary;
select e.firstname,sum(e.salary+i.incentive_amount) from employeetable e join incentives i on e.emp_id=i.id group by e.firstname,e.salary;
-- Select first_name, incentive amount from employee and incentives table for those employees who have incentives
select e.firstname,i.incentive_amount from employeetable e join incentives i where e.emp_id=i.id;
-- Select first_name, incentive amount from employee and incentives table for those employees who have incentives and incentive amount greater than 3000
select e.firstname,i.incentive_amount from employeetable e join incentives i where e.emp_id = i.id order by i.incentive_amount>3000;
-- Select first_name, incentive amount from employee and incentives table for all employes even if they didn't get incentives
select e.firstname,i.incentive_amount from employeetable e join incentives i on e.emp_id = i.id;
-- Select first_name, incentive amount from employee and incentives table for all employees even if they didn't get incentives and set incentive amount as 0 for those employees who didn't get incentives.
select e.firstname,(ifnull(i.incentive_amount,0)) from employeetable e left join incentives i on e.emp_id = i.id;
--  Select first_name, incentive amount from employee and incentives table for all employees who got incentives using left join
select e.firstname,i.incentive_amount from employeetable e left join incentives i on e.emp_id = i.id;
-- Select max incentive with respect to employee from employee and incentives table using sub query
select e.firstname,max(i.incentive_amount) from employeetable e join incentives i on e.emp_id = i.id group by  e.first_name;






